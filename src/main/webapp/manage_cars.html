<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0"/>
  <title>Manage Cars</title>
  <link rel="stylesheet" href="stylesCar.css" />
</head>
<body>
  <div class="sidebar">
    <h1>RentC</h1>
    <a href="adminDashboard.jsp">Dashboard</a>
    <a href="dashboard.jsp">Home</a>
    <a href="manage_cars.html">Manage Cars</a>
    <a href="manage_users.html">Manage Users</a>
    <a href="manage_bookings.html">Manage Bookings</a>
    <a href="index.html">logout</a>
  </div>

  <div class="main">
    <div class="top-bar">
      <span class="admin-label">Manage Cars</span>
      <button class="profile-btn" title="Profile">
        <svg viewBox="0 0 24 24">
          <path d="M12 12c2.7 0 5-2.3 5-5s-2.3-5-5-5-5 2.3-5 5 2.3 5 5 5zm0 2c-3.3 0-10 1.7-10 5v3h20v-3c0-3.3-6.7-5-10-5z"/>
        </svg>
      </button>
    </div>

    <div class="button-group">
      <button class="active-btn" onclick="filterStatus('Available')">Available</button>
      <button class="inactive-btn" onclick="filterStatus('Rented')">Rented</button>
      <button class="delete-btn" onclick="deleteSelected()">Delete</button>
      <button class="new-btn" onclick="addNewCar()">New</button>
      <button class="export-btn" onclick="exportCars()">Export All Cars</button>
    </div>

    <h2>Car Details</h2>
    <table>
      <thead>
        <tr>
          <th><input type="checkbox" onclick="toggleAll(this)"/></th>
          <th>Car ID</th>
          <th>Model</th>
          <th>Year</th>
          <th>Colour</th>
          <th>Price/Day</th>
          <th>Available Date</th>
          <th>Status</th>
        </tr>
      </thead>
      <tbody id="car-table-body">
        <!-- Data will be populated here -->
      </tbody>
    </table>
  </div>

  <script>
    let cars = [
      {
        carId: "C001",
        model: "Toyota Prius",
        year: "2021",
        colour: "White",
        price: "10000",
        availableDate: "2025-05-10",
        status: "Available"
      },
      {
        carId: "C002",
        model: "Honda Civic",
        year: "2020",
        colour: "Black",
        price: "9500",
        availableDate: "2025-05-15",
        status: "Rented"
      }
    ];

    let filteredStatus = null;

    function populateTable() {
      const tableBody = document.getElementById("car-table-body");
      tableBody.innerHTML = "";

      const filtered = filteredStatus
        ? cars.filter(car => car.status === filteredStatus)
        : cars;

      filtered.forEach((car, index) => {
        const row = document.createElement("tr");
        row.innerHTML = `
          <td><input type="checkbox" data-index="${index}"></td>
          <td>${car.carId}</td>
          <td>${car.model}</td>
          <td>${car.year}</td>
          <td>${car.colour}</td>
          <td>${car.price}</td>
          <td>${car.availableDate}</td>
          <td><span class="status ${car.status}">${car.status}</span></td>
        `;
        tableBody.appendChild(row);
      });
    }

    function toggleAll(masterCheckbox) {
      const checkboxes = document.querySelectorAll('#car-table-body input[type="checkbox"]');
      checkboxes.forEach(cb => cb.checked = masterCheckbox.checked);
    }

    function deleteSelected() {
      const checkboxes = document.querySelectorAll('#car-table-body input[type="checkbox"]:checked');
      const indicesToDelete = Array.from(checkboxes).map(cb => parseInt(cb.dataset.index));
      cars = cars.filter((_, index) => !indicesToDelete.includes(index));
      populateTable();
    }

    function addNewCar() {
      const carId = prompt("Enter Car ID:");
      const model = prompt("Enter Model:");
      const year = prompt("Enter Year:");
      const colour = prompt("Enter Colour:");
      const price = prompt("Enter Price/Day:");
      const availableDate = prompt("Enter Available Date (YYYY-MM-DD):");
      const status = prompt("Enter Status (Available/Rented):");

      if (carId && model && year && colour && price && availableDate && status) {
        cars.push({ carId, model, year, colour, price, availableDate, status });
        populateTable();
      } else {
        alert("Please fill all fields!");
      }
    }

    function filterStatus(status) {
      filteredStatus = status;
      populateTable();
    }

    function exportCars() {
      let csvContent = "Car ID,Model,Year,Colour,Price/Day,Available Date,Status\n";
      cars.forEach(c => {
        csvContent += `${c.carId},${c.model},${c.year},${c.colour},${c.price},${c.availableDate},${c.status}\n`;
      });

      const blob = new Blob([csvContent], { type: "text/csv" });
      const url = URL.createObjectURL(blob);
      const a = document.createElement("a");
      a.href = url;
      a.download = "cars.csv";
      document.body.appendChild(a);
      a.click();
      document.body.removeChild(a);
    }

    // Initial load
    populateTable();
  </script>
</body>
</html>

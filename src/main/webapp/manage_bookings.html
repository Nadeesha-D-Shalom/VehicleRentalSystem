<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0"/>
  <title>Manage Bookings</title>
  <link rel="stylesheet" href="stylesManage.css">
</head>
<body>
<div class="sidebar">
  <h1>RentC</h1>
  <a href="adminDashboard.jsp">Dashboard</a>
  <a href="dashboard.jsp">Home</a>
  <a href="manage_cars.html">Manage Cars</a>
  <a href="manage_users.html">Manage Users</a>
  <a href="manage_bookings.html">Manage Bookings</a>
  <a href="index.html">logout</a>
</div>

<div class="main">
  <div class="top-bar">
    <span class="admin-label">Manage Bookings</span>
    <button class="profile-btn" title="Profile">
      <svg viewBox="0 0 24 24">
        <path d="M12 12c2.7 0 5-2.3 5-5s-2.3-5-5-5-5 2.3-5 5 2.3 5 5 5zm0 2c-3.3 0-10 1.7-10 5v3h20v-3c0-3.3-6.7-5-10-5z"/>
      </svg>
    </button>
  </div>

  <div class="button-group">
    <button class="new-btn" onclick="addNewRow()">New</button>
    <button class="delete-btn" onclick="deleteSelected()">Delete</button>
    <button class="export-btn" onclick="exportBookings()">Export All Bookings</button>
  </div>

  <h2>Booking Details</h2>
  <table>
    <thead>
    <tr>
      <th><input type="checkbox" onclick="toggleAll(this)"/></th>
      <th>Booking ID</th>
      <th>Car ID</th>
      <th>Car Model</th>
      <th>Customer Name</th>
      <th>Booking Date</th>
      <th>Return Date</th>
      <th>Payment Amount</th>
    </tr>
    </thead>
    <tbody id="booking-table-body">
    <!-- Data will be populated here -->
    </tbody>
  </table>
</div>

<script>
  let bookings = [
    {
      bookingId: "B001",
      carId: "C123",
      carModel: "Toyota Corolla",
      customerName: "Alice Johnson",
      bookingDate: "2025-05-01",
      returnDate: "2025-05-05",
      payment: "25000"
    },
    {
      bookingId: "B002",
      carId: "C456",
      carModel: "Honda Civic",
      customerName: "Mark Smith",
      bookingDate: "2025-05-03",
      returnDate: "2025-05-07",
      payment: "30000"
    }
  ];

  function populateTable() {
    const tableBody = document.getElementById("booking-table-body");
    tableBody.innerHTML = "";

    bookings.forEach((b, index) => {
      const row = document.createElement("tr");
      row.innerHTML = `
          <td><input type="checkbox" data-index="${index}"></td>
          <td>${b.bookingId}</td>
          <td>${b.carId}</td>
          <td>${b.carModel}</td>
          <td>${b.customerName}</td>
          <td>${b.bookingDate}</td>
          <td>${b.returnDate}</td>
          <td>${b.payment}</td>
        `;
      tableBody.appendChild(row);
    });
  }

  function toggleAll(masterCheckbox) {
    const checkboxes = document.querySelectorAll('#booking-table-body input[type="checkbox"]');
    checkboxes.forEach(cb => cb.checked = masterCheckbox.checked);
  }

  function deleteSelected() {
    const checkboxes = document.querySelectorAll('#booking-table-body input[type="checkbox"]:checked');
    const indicesToDelete = Array.from(checkboxes).map(cb => parseInt(cb.dataset.index));
    bookings = bookings.filter((_, index) => !indicesToDelete.includes(index));
    populateTable();
  }

  function addNewRow() {
    const bookingId = prompt("Enter Booking ID:");
    const carId = prompt("Enter Car ID:");
    const carModel = prompt("Enter Car Model:");
    const customerName = prompt("Enter Customer Name:");
    const bookingDate = prompt("Enter Booking Date (YYYY-MM-DD):");
    const returnDate = prompt("Enter Return Date (YYYY-MM-DD):");
    const payment = prompt("Enter Payment Amount:");

    if (bookingId && carId && carModel && customerName && bookingDate && returnDate && payment) {
      bookings.push({ bookingId, carId, carModel, customerName, bookingDate, returnDate, payment });
      populateTable();
    } else {
      alert("Please fill all fields!");
    }
  }

  function exportBookings() {
    let csvContent = "Booking ID,Car ID,Car Model,Customer Name,Booking Date,Return Date,Payment Amount\n";
    bookings.forEach(b => {
      csvContent += `${b.bookingId},${b.carId},${b.carModel},${b.customerName},${b.bookingDate},${b.returnDate},${b.payment}\n`;
    });

    const blob = new Blob([csvContent], { type: "text/csv" });
    const url = URL.createObjectURL(blob);
    const a = document.createElement("a");
    a.href = url;
    a.download = "bookings.csv";
    document.body.appendChild(a);
    a.click();
    document.body.removeChild(a);
  }

  populateTable();
</script>
</body>
</html>
